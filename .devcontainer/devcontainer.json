{
  "name": "Fukuii Scala Development",
  "image": "mcr.microsoft.com/devcontainers/java:21",
  
  "features": {
    "ghcr.io/devcontainers/features/java:1": {
      "version": "21",
      "jdkDistro": "tem"
    },
    "ghcr.io/devcontainers/features/git:1": {
      "version": "latest"
    },
    "ghcr.io/devcontainers/features/docker-in-docker:1": {
      "version": "latest"
    }
  },
  
  "customizations": {
    "vscode": {
      "extensions": [
        "scalameta.metals",
        "scala-lang.scala",
        "ms-vscode.vscode-typescript-next"
      ],
      "settings": {
        "files.watcherExclude": {
          "**/target/**": true,
          "**/.bloop/**": true,
          "**/.metals/**": true
        }
      }
    }
  },
  
  "postCreateCommand": "bash -c 'sudo chown -R vscode:vscode $HOME/.sbt $HOME/.ivy2 || true && git submodule update --init --recursive && source /usr/local/sdkman/bin/sdkman-init.sh && sdk install sbt && echo \"source /usr/local/sdkman/bin/sdkman-init.sh\" >> $HOME/.bashrc && echo \"source /usr/local/sdkman/bin/sdkman-init.sh\" >> $HOME/.zshrc && sdk version && sbt sbtVersion'",
  
  "containerEnv": {
    "FUKUII_DEV": "true",
    "JAVA_OPTS": "-Xms1g -Xmx4g -XX:ReservedCodeCacheSize=1024m -XX:MaxMetaspaceSize=1g -Xss4M"
  },
  
  "remoteUser": "vscode",
  
  "mounts": [
    "source=fukuii-ivy2-cache,target=/home/vscode/.ivy2,type=volume",
    "source=fukuii-sbt-cache,target=/home/vscode/.sbt,type=volume",
    "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind"
  ],
  "runArgs": ["--privileged"]
}
