# Testbed Configuration - ETC Mainnet Fast Sync Testing
# This configuration re-enables the legacy fast sync pipeline to validate
# catch-up performance on the ETC public network and capture fast-sync logs.
# Focus is on verifying peer capability exchange, fast-sync progress, and timeouts.

# This is the base configuration file for the Fukuii ETC client.
include "conf/base/fukuii.conf"

# This where all the default settings are defined.
# It should always go at the top.
include "conf/base/pekko.conf"
include "conf/base/logging.conf"

# Keep logging at a geth-like baseline (INFO) so sync + node status is visible
# without flooding logs with per-message devp2p/RLPx traffic.
logging.logs-level = "INFO"

# Pekko defaults to DEBUG in conf/base/pekko.conf; pin it to INFO for this harness.
pekko.loglevel = "INFO"

# Dead-letter logging is very noisy at INFO during sync; disable it for this harness.
pekko.log-dead-letters = 0

fukuii {
  # Persist all Fukuii state (including node.key) on the mounted /app/data volume.
  # Without this override, the default datadir is ${user.home}/.fukuii/<network>,
  # which is not persisted by the cirith-ungol docker-compose harness.
  datadir = "/app/data"

  blockchains {
    # Network set to ETC (mainnet)
    network = "etc"

    # Match Core-Geth's ETC networkid (61). Some built-in configs use network-id=1,
    # which causes eth protocol handshake failures even when chain-id is 0x3d.
    etc {
      network-id = 61
    }
  }

  sync {
  # Enable SNAP sync to test the validation loop fix
  do-snap-sync = true

  # Enable FastSync for ETC mainnet validation
  do-fast-sync = true

    # Keep extended timeouts from previous test
    # These give peers more time to respond to fast sync requests
    peer-response-timeout = 90.seconds

    # Keep reduced blacklist durations from previous test
    # This allows faster retry if peers do get blacklisted
    blacklist-duration = 60.seconds

    # Keep reduced critical blacklist duration from previous test
    critical-blacklist-duration = 30.minutes

    snap-sync {
      # Extended timeout to capture full request lifecycle
      request-timeout = 60.seconds
    }
  }

  network {
    rpc {
      http {
        # Bind RPC to all interfaces for testbed access from host machine
        # WARNING: Only use 0.0.0.0 in isolated test environments. Use 127.0.0.1 for production.
        interface = "0.0.0.0"
      }
    }

    peer {
      # Keep reduced short blacklist duration from previous test
      short-blacklist-duration = 2.minutes

      # Keep reduced long blacklist duration from previous test
      long-blacklist-duration = 30.minutes
    }
  }
}
